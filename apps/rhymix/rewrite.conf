# Rhymix - https://rhymix.org/
# GitHub: https://github.com/rhymix/rhymix
# Rewrite Rules: https://github.com/rhymix/rhymix/wiki/Rewrite
# updated: 2025-10-24

# Reserve layout, widgets, addons templates
rewrite ^/(layouts|m\.layouts|widgets|widgetstyles|addons)/(.+)/(conf|queries|schemas)/(.+)\.(xml|html)$ /index.php last;

# Static files for layouts, widgets, addons
rewrite ^/files/(member_extra_info|attach|cache|thumbnails|faceOff)/(.*) /files/$1/$2 last;
rewrite ^/(.+)/(files|modules|widgets|widgetstyles|layouts|m\.layouts|addons)/(.*) /$2/$3 last;

# RSS, blogAPI
rewrite ^/(rss|atom)$ /index.php?module=rss&act=$1 last;
rewrite ^/([a-zA-Z0-9_]+)/(rss|atom|api)$ /index.php?mid=$1&act=$2 last;
rewrite ^/([a-zA-Z0-9_]+)/([a-zA-Z0-9_]+)/(rss|atom|api)$ /index.php?vid=$1&mid=$2&act=$3 last;

# Trackback
rewrite ^/([0-9]+)/(.+)/trackback$ /index.php?document_srl=$1&key=$2&act=trackback last;
rewrite ^/([a-zA-Z0-9_]+)/([0-9]+)/(.+)/trackback$ /index.php?mid=$1&document_srl=$2&key=$3&act=trackback last;

# Admin page
rewrite ^/admin/?$ /index.php?module=admin last;

# Document permanent link
rewrite ^/([0-9]+)$ /index.php?document_srl=$1 last;

# Mid link (하이픈 지원 추가)
rewrite ^/([a-zA-Z0-9_-]+)/?$ /index.php?mid=$1 last;

# Mid + document link
rewrite ^/([a-zA-Z0-9_-]+)/([0-9]+)$ /index.php?mid=$1&document_srl=$2 last;

# Vid + mid link
rewrite ^/([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/?$ /index.php?vid=$1&mid=$2 last;

# Vid + mid + document link
rewrite ^/([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/([0-9]+)$ /index.php?vid=$1&mid=$2&document_srl=$3 last;

